/*! (c) Andrea Giammarchi */
const{is:t}=Object;let s;const e=t=>{const e=s;s=e||[];try{if(t(),!e)for(const{value:t}of s);}finally{s=e}};class n{constructor(t){this._=t}then(){return this.value}toJSON(){return this.value}toString(){return this.value}valueOf(){return this.value}}let o;class r extends n{constructor(t,s,e,n){super(t),this.f=n,this.$=!0,this.r=new Set,this.s=new d(s,e)}get value(){if(this.$){const t=o;o=this;try{this.s.value=this._(this.s._)}finally{this.$=!1,o=t}}return this.s.value}}const i={async:!1,equals:!0},c=(t,s,e=i)=>new r(t,s,e,!1);let l;const h=[],a=()=>{},u=({s:t})=>{"function"==typeof t._&&(t._=t._())};class f extends r{constructor(t,s,e){super(t,s,e,!0),this.e=h}run(){return this.$=!0,this.value,this}stop(){this._=a,this.r.clear(),this.s.c.clear()}}class p extends f{constructor(t,s,e){super(t,s,e),this.i=0,this.a=!!e.async,this.m=!0,this.e=[]}get value(){this.a?this.async():this.sync()}async(){this.m&&(this.m=!1,queueMicrotask((()=>{this.m=!0,this.sync()})))}sync(){const t=l;(l=this).i=0,u(this),super.value,l=t}stop(){super.stop(),u(this);for(const t of this.e.splice(0))t.stop()}}const g=()=>!1;class d extends n{constructor(s,{equals:e}){super(s),this.c=new Set,this.s=!0===e?t:e||g}peek(){return this._}get value(){return o&&(this.c.add(o),o.r.add(this)),this._}set value(t){const e=this._;if(!this.s(this._=t,e)&&this.c.size){const t=[],e=[this];for(const s of e)for(const n of s.c)if(!n.$&&n.r.has(s))if(n.r.clear(),n.$=!0,n.f){t.push(n);const s=[n];for(const t of s)for(const e of t.e)e.r.clear(),e.$=!0,s.push(e)}else e.push(n.s);for(const e of t)s?s.push(e):e.value}}}const y=(t,s=i)=>new d(t,s),v={async:!1},_=(t,s)=>((t,s,e=i)=>{let n;if(l){const{i:o,e:r}=l,i=o===r.length;(i||r[o]._!==t)&&(i||r[o].stop(),r[o]=new p(t,s,e).run()),n=r[o],l.i++}else n=new p(t,s,e).run();return()=>{n.stop()}})(t,s,v)
/*! (c) Andrea Giammarchi - ISC */,m=[],k=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,w=/[&<>'"]/g,b=t=>x[t],x={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},$=t=>t.replace(w,b)
/*! (c) Andrea Giammarchi - ISC */,{isArray:N}=Array,{entries:S}=Object,j=(t,s)=>{const e=s?t.value:t;return null==e?"":e},C=t=>{switch(t){case"__token":case"key":case"is":return!1}return!0},q={async:!1,equals:!0},A=(t,s)=>{for(let e=0;e<t.length;e++)s=s[t[e]].args;return s},B=(t,s)=>{const e=t.length-1;for(let n=0;n<e;n++)s=s[t[n]].args;return s[t[e]].value},M=(t,s)=>{for(let e=0;e<t.length;e++)s=s.childNodes[t[e]];return s},O=new Map;let W=!1;const E=(t,s)=>{W=!0,O.set(t,s)},T=(t,s,e,n)=>{if(W&&O.has(s))O.get(s)(t,e,n);else if(n[s]!==e)switch(n[s]=e,s){case"class":s+="Name";case"className":case"textContent":t[s]=e;break;case"ref":e.current=t;break;default:s.startsWith("on")?t[s.toLowerCase()]=e:s in t?t[s]=e:null==e?t.removeAttribute(s):t.setAttribute(s,e)}},L=(t,s,e,n)=>{const o=e.length;let r=s.length,i=o,c=0,l=0,h=null;for(;c<r||l<i;)if(r===c){const s=i<o?l?e[l-1].nextSibling:e[i-l]:n;for(;l<i;)t.insertBefore(e[l++],s)}else if(i===l)for(;c<r;)h&&h.has(s[c])||s[c].remove(),c++;else if(s[c]===e[l])c++,l++;else if(s[r-1]===e[i-1])r--,i--;else if(s[c]===e[i-1]&&e[l]===s[r-1]){const n=s[--r].nextSibling;t.insertBefore(e[l++],s[c++].nextSibling),t.insertBefore(e[--i],n),s[r]=e[i]}else{if(!h){h=new Map;let t=l;for(;t<i;)h.set(e[t],t++)}if(h.has(s[c])){const n=h.get(s[c]);if(l<n&&n<i){let o=c,a=1;for(;++o<r&&o<i&&h.get(s[o])===n+a;)a++;if(a>n-l){const o=s[c];for(;l<n;)t.insertBefore(e[l++],o)}else t.replaceChild(e[l++],s[c++])}else c++}else s[c++].remove()}return e};
/*! (c) Andrea Giammarchi - ISC */
class z{constructor(t,s,e,n,o){this.fragment="symbol"===t,this.type=t,this.child=s,this.tree=e,this.details=n,this.html=o}next(t,s,e){return new z(t,this.child.concat(s),e,this.details,this.html)}parse(t){return J.apply(this,t),this}push(t,s=!1,e=this.child,n=this.tree){this.details.push({child:e,tree:n,props:t,hole:s})}}const H=(t,s,e)=>{let n;if(t){const{length:t}=s;if(t){const o=s[t-1];n=s.slice(0,-1).concat(o+e)}else n=m}else n=s.concat(e);return n};function J(t,s){const{type:e,html:n}=this,{length:o}=arguments;switch(e){case"string":if(n.push(`<${t}`),s){const{is:t}=s;if(t&&n.push(` is="${t}"`),s instanceof D)this.push(m);else{const t=[];for(const[e,o]of S(s))C(e)&&(o instanceof D?t.push(e):n.push(` ${"className"===e?"class":e}="${$(o)}"`));t.length&&this.push(t)}}return 2===o?n.push(k.test(t)?" />":`></${t}>`):(n.push(">"),R.apply(this,arguments),n.push(`</${t}>`)),1;case"function":return n.push("\x3c!--ðŸ™Š--\x3e"),this.push(null),1;case"symbol":return R.apply(this,arguments)}throw new Error(t)}function R(t,s){const{fragment:e,child:n,tree:o,html:r}=this,i=e&&!s?.__token;let c=0;for(let t=2;t<arguments.length;t++){const s=arguments[t];if("object"==typeof s)if(s instanceof D)r.push("\x3c!--ðŸ™Š--\x3e"),this.push(null,!0,n.concat(t),H(i,o,c++));else{const{type:e,args:n}=s;c+=J.apply(this.next(e,t,H(i,o,c)),n)}else c++,r.push(s)}return c}class D{constructor(t){this.value=t}}class F{constructor(){this.__token=null,this.store=null}get nodes(){return this.store.nodes}}class G extends F{constructor(t){super().key=t}}class I{constructor(t,s,e){this.args=null,this.nodes=e,this.updates=s,this.refresh(t)}refresh(t){if(this.args!==t){this.args=t;for(const t of this.updates)t(this.args)}}}class K{constructor(t,s,e){var n;this.args=t,this.calc=!1,this.init=!0,this.keys=null,this.effect=(n=()=>{const{args:t,calc:n,init:o,keys:r}=this;let[i,c,...l]=t;if(o){if(this.init=!1,c)if(c instanceof D)this.keys=m,c=c.value;else{const t=[];for(const[s,e]of S(c))e instanceof D&&(t.push(s),c[s]=e.value);t.length&&(this.keys=t)}}else if(n)if(this.calc=!1,r===m)c=c.value;else if(r)for(const t of r)c[t]=c[t].value;if(this.result=i(c,...l),o){const{type:t,args:n}=this.result,[o,r]=s(n[1].__token,t,n);this.nodes=e(o,r,this.updates=[],"symbol"!==t)}for(const t of this.updates)t(this.result.args)},new p(n,void 0,q).run())}refresh(t){this.args!==t&&(this.args=t,this.calc=!0,this.effect.run())}}
/*! (c) Andrea Giammarchi - ISC */const P=Symbol();function Q(t){return{type:typeof t,args:arguments}}const U=t=>new D(t),V=new WeakMap,X=(t,s)=>{"function"==typeof t&&(t=t());const{__token:e}=t.args[1];let n=V.get(s);n&&n.__token===e?rt(n,t):(n=new F,ot(n,e,t),s.replaceChildren(...n.nodes),V.set(s,n))};let{document:Y}=globalThis;const Z=t=>{Y=t},tt=(t,s,e,n)=>{const o=st(t,s,e);return n?[o]:[...o.childNodes]},st=(t,s,e)=>{const o=Y.importNode(t,!0);return((t,s,e)=>{for(const{child:o,tree:r,props:i,hole:c}of s){const s=M(r,t);if(i){const t={};e.push(i.length?e=>{const n=A(o,e)[1];for(const e of i)T(s,e,n[e].value,t)}:e=>{const n=A(o,e)[1].value;for(const[e,o]of S(n))C(e)&&T(s,e,o,t)})}else{const t=e.push(c?r=>{const i=B(o,r);if("object"==typeof i)if(N(i)){const{parentNode:n}=s;let c=!1,l=null,h=m,a=m;(e[t]=(t,e=B(o,t))=>{const r=[],i=[],{length:u}=h;let f=0;for(;f<e.length;f++){const t=f<u,s=e[f],{__token:n,key:o}=s.args[1];c||void 0===o||(c=!0,l={});let a=t?h[f]:null;t&&n===a.__token&&(!c||o.value===a.key)||c&&(a=l[o.value])?rt(a,s):(c?(a=new G(o.value),l[o.value]=a):a=new F,ot(a,n,s)),i.push(a),r.push(...a.nodes)}if(f)a=L(n,a,r,s),h=i;else{const{length:t}=a;if(t){const s=Y.createRange();s.setStartBefore(a[0]),s.setEndAfter(a[t-1]),s.deleteContents(),a=m,c&&(l={})}h=m}})(r,i)}else{const c=i instanceof n;if(c&&"object"!=typeof i.peek())e[t]=it(o,s,i,!0);else{const{parentNode:n}=s,l=new F;(e[t]=(t,e=B(o,t))=>{const r=j(e,c),{__token:i}=r.args[1];if(i===l.__token)rt(l,r);else{const{nodes:t}=l;ot(l,i,r),L(n,t,l.nodes,s)}})(r,i)}}else e[t]=it(o,s,j(i,!1),!1)}:n=>{const r=et(A(o,n));s.replaceWith(...r.nodes),e[t]=t=>{r.refresh(A(o,t))}})-1}}})(o,s,e),o},et=t=>new K(t,nt,tt),nt=(t,s,e)=>{let{info:n}=t;if(!n){const{html:o,fragment:r,details:i}=new z(s,m,m,[],[]).parse(e),c=Y.createElement("template");c.innerHTML=o.join("");const{content:l}=c;t.info=n=[r?l:l.firstChild,i]}return n},ot=(t,s,{type:e,args:n})=>{if(t.__token=s,"function"===e)t.store=et(n);else{const o=[],[r,i]=nt(s,e,n),c=tt(r,i,o,"string"===e);t.store=new I(n,o,c)}},rt=({store:t},{args:s})=>{t.refresh(s)},it=(t,s,e,n)=>{const o=Y.createTextNode(n?"":e);if(s.replaceWith(o),n){const s=new f((()=>{o.data=j(e,n)}),void 0,q).run();return n=>{const o=B(t,n);o!==e&&(e=o,s.run())}}return s=>{const r=j(B(t,s),n);r!==e&&(e=r,o.data=r)}};export{p as Effect,f as FX,P as Fragment,n as Signal,e as batch,c as computed,Q as createElement,_ as effect,U as interpolation,X as render,y as signal,Z as useDocument,E as useProperty};
