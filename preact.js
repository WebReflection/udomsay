function t(){throw new Error("Cycle detected")}function i(){if(o>1)return void o--;let t,i=!1;for(;void 0!==n;){let e=n;for(n=void 0,r++;void 0!==e;){const s=e.o;if(e.o=void 0,e.f&=-3,!(8&e.f)&&a(e))try{e.c()}catch(e){i||(t=e,i=!0)}e=s}}if(r=0,o--,i)throw t}function e(t){if(o>0)return t();o++;try{return t()}finally{i()}}let s,n,o=0,r=0,c=0;function h(t){if(void 0===s)return;let i=t.n;return void 0===i||i.t!==s?(i={i:0,S:t,p:s.s,n:void 0,t:s,e:void 0,x:void 0,r:i},void 0!==s.s&&(s.s.n=i),s.s=i,t.n=i,32&s.f&&t.S(i),i):-1===i.i?(i.i=0,void 0!==i.n&&(i.n.p=i.p,void 0!==i.p&&(i.p.n=i.n),i.p=s.s,i.n=void 0,s.s.n=i,s.s=i),i):void 0}function f(t){this.v=t,this.i=0,this.n=void 0,this.t=void 0}function u(t){return new f(t)}function a(t){for(let i=t.s;void 0!==i;i=i.n)if(i.S.i!==i.i||!i.S.h()||i.S.i!==i.i)return!0;return!1}function l(t){for(let i=t.s;void 0!==i;i=i.n){const e=i.S.n;if(void 0!==e&&(i.r=e),i.S.n=i,i.i=-1,void 0===i.n){t.s=i;break}}}function d(t){let i,e=t.s;for(;void 0!==e;){const t=e.p;-1===e.i?(e.S.U(e),void 0!==t&&(t.n=e.n),void 0!==e.n&&(e.n.p=t)):i=e,e.S.n=e.r,void 0!==e.r&&(e.r=void 0),e=t}t.s=i}function p(t){f.call(this,void 0),this.x=t,this.s=void 0,this.g=c-1,this.f=4}function v(t){return new p(t)}function y(t){const e=t.u;if(t.u=void 0,"function"==typeof e){o++;const n=s;s=void 0;try{e()}catch(i){throw t.f&=-2,t.f|=8,g(t),i}finally{s=n,i()}}}function g(t){for(let i=t.s;void 0!==i;i=i.n)i.S.U(i);t.x=void 0,t.s=void 0,y(t)}function S(t){if(s!==this)throw new Error("Out-of-order effect");d(this),s=t,this.f&=-2,8&this.f&&g(this),i()}function b(t){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function w(t){const i=new b(t);try{i.c()}catch(t){throw i.d(),t}return i.d.bind(i)}f.prototype.h=function(){return!0},f.prototype.S=function(t){this.t!==t&&void 0===t.e&&(t.x=this.t,void 0!==this.t&&(this.t.e=t),this.t=t)},f.prototype.U=function(t){if(void 0!==this.t){const i=t.e,e=t.x;void 0!==i&&(i.x=e,t.e=void 0),void 0!==e&&(e.e=i,t.x=void 0),t===this.t&&(this.t=e)}},f.prototype.subscribe=function(t){const i=this;return w((function(){const e=i.value,s=32&this.f;this.f&=-33;try{t(e)}finally{this.f|=s}}))},f.prototype.valueOf=function(){return this.value},f.prototype.toString=function(){return this.value+""},f.prototype.peek=function(){return this.v},Object.defineProperty(f.prototype,"value",{get(){const t=h(this);return void 0!==t&&(t.i=this.i),this.v},set(e){if(e!==this.v){r>100&&t(),this.v=e,this.i++,c++,o++;try{for(let t=this.t;void 0!==t;t=t.x)t.t.N()}finally{i()}}}}),(p.prototype=new f).h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f))return!0;if(this.f&=-5,this.g===c)return!0;if(this.g=c,this.f|=1,this.i>0&&!a(this))return this.f&=-2,!0;const t=s;try{l(this),s=this;const t=this.x();(16&this.f||this.v!==t||0===this.i)&&(this.v=t,this.f&=-17,this.i++)}catch(t){this.v=t,this.f|=16,this.i++}return s=t,d(this),this.f&=-2,!0},p.prototype.S=function(t){if(void 0===this.t){this.f|=36;for(let t=this.s;void 0!==t;t=t.n)t.S.S(t)}f.prototype.S.call(this,t)},p.prototype.U=function(t){if(void 0!==this.t&&(f.prototype.U.call(this,t),void 0===this.t)){this.f&=-33;for(let t=this.s;void 0!==t;t=t.n)t.S.U(t)}},p.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(let t=this.t;void 0!==t;t=t.x)t.t.N()}},p.prototype.peek=function(){if(this.h()||t(),16&this.f)throw this.v;return this.v},Object.defineProperty(p.prototype,"value",{get(){1&this.f&&t();const i=h(this);if(this.h(),void 0!==i&&(i.i=this.i),16&this.f)throw this.v;return this.v}}),b.prototype.c=function(){const t=this.S();try{8&this.f||void 0===this.x||(this.u=this.x())}finally{t()}},b.prototype.S=function(){1&this.f&&t(),this.f|=1,this.f&=-9,y(this),l(this),o++;const i=s;return s=this,S.bind(this,i)},b.prototype.N=function(){2&this.f||(this.f|=2,this.o=n,n=this)},b.prototype.d=function(){this.f|=8,1&this.f||g(this)};var N=(0,Object.freeze)([]),x=()=>{};const m=(t,i,e)=>{const{parentNode:s}=e,n=i.length;let o=t.length,r=n,c=0,h=0,f=null;for(;c<o||h<r;)if(o===c){const t=r<n?h?i[h-1].nextSibling:i[r-h]:e;for(;h<r;)s.insertBefore(i[h++],t)}else if(r===h)for(;c<o;)f&&f.has(t[c])||t[c].remove(),c++;else if(t[c]===i[h])c++,h++;else if(t[o-1]===i[r-1])o--,r--;else if(t[c]===i[r-1]&&i[h]===t[o-1]){const e=t[--o].nextSibling;s.insertBefore(i[h++],t[c++].nextSibling),s.insertBefore(i[--r],e),t[o]=i[r]}else{if(!f){f=new Map;let t=h;for(;t<r;)f.set(i[t],t++)}if(f.has(t[c])){const e=f.get(t[c]);if(h<e&&e<r){let n=c,u=1;for(;++n<o&&n<r&&f.get(t[n])===e+u;)u++;if(u>e-h){const n=t[c];for(;h<e;)s.insertBefore(i[h++],n)}else s.replaceChild(i[h++],t[c++])}else c++}else t[c++].remove()}return i},{isArray:T}=Array,{getPrototypeOf:E,prototype:{isPrototypeOf:O}}=Object,{COMPONENT:k,ELEMENT:A,FRAGMENT:C,INTERPOLATION:M,STATIC:P}=class{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;get properties(){const{attributes:t}=this;if(t.length){const i={};for(const e of t)e.type<2?i[e.name]=e.value:Object.assign(i,e.value);return i}return null}},I=({childNodes:t},i)=>t[i],U=({children:t},i)=>t[i],B=({value:t,properties:i,children:e})=>t(i,...e),R=({name:t})=>"key"===t,$=(t,{content:i})=>t.reduce(I,i),j=(t,i)=>t.reduce(U,i),L=(t,i)=>{const e=null==i?"":String(i);e!==t.data&&(t.data=e)};
/*! (c) Andrea Giammarchi - ISC */var F=(t={})=>{const i=t.document||globalThis.document,e=new Map(t.plugins||[]),s=!!e.size,n=t.diff||m,o=t.effect||(t=>(t(),x)),r=t.getPeek||(t=>t.peek()),c=t.getValue||(t=>t.value),h=t.isSignal||(t.Signal?O.bind(t.Signal.prototype):()=>!1),f=t=>i.createTextNode(t),u=(t,i)=>{t.dispose();const e=o((()=>{const e=B(i);e.id!==t.id?t=a(t,e,!1):t.update(e)}));return t.dispose=e,t},a=(t,i,e)=>i.type===k?u(t,i):((t,i,e)=>(t.dispose(),t=new l(i),e?t.dispose=o((()=>t.update(i))):t.update(i),t))(t,i,e);class l{constructor(t,i=!0){const[e,s]=i?S(t):[N,null];this._=i&&t.type===C,this.id=t.id,this.updates=e,this.content=s,this.dispose=x}get $(){const{content:t,_:i}=this;return i?(this._=!i,(this.content=(({childNodes:t})=>({childNodes:[...t]}))(t)).childNodes):[t]}update(t){for(const i of this.updates)i.call(this,t)}}const d=new l({id:null},!1),p={id:null,view:d},v=new WeakMap;let y;const g=new WeakMap,S=t=>{let i=g.get(t.id);if(!i){const e=[],s=V(t,e,[],N,!1);g.set(t.id,i=[e,s])}const[e,s]=i;return[e.slice(),s.cloneNode(!0)]},b=(t,i,e,s)=>{s?t.setAttribute(i,e):t[i]=e},w=(t,i,e,s,n)=>{if(h(e)){const r="ðŸ™Š"+i;r in s&&s[r](),s[r]=o((()=>{b(t,i,c(e),n)}))}else b(t,i,e,n)},I=(t,i,n,o)=>{if(s&&e.has(i))e.get(i)(t,n,o);else if(o[i]!==n)switch(o[i]=n,i){case"class":i+="Name";case"className":case"textContent":w(t,i,n,o,!1);break;case"ref":n.current=t;break;default:i.startsWith("on")?t[i.toLowerCase()]=n:i in t?w(t,i,n,o,!1):null==n?t.removeAttribute(i):w(t,i,n,o,!0)}},U=(t,i,e)=>function(s){const n={},o=$(i,this);(this.updates[e]=e=>{const{attributes:s}=j(i,e);for(const i of t){const{name:t,value:e}=s[i];I(o,t,e,n)}})(s)},F=(t,e)=>function(s){let o=N,r=!0,c=-1;const h=$(t,this),f=new Map;(this.updates[e]=e=>{const{value:s}=j(t,e),u=[];for(let t=0;t<s.length;t++){const i=s[t];r&&(r=!r,c=i.attributes.findIndex(R));const e=c<0?t:i.attributes[c].value;let{id:n,view:o}=f.get(e)||p;n!==i.id?(o=a(o,i,!1),f.set(e,{id:i.id,view:o})):o.update(i),u.push(...o.$)}if(u.length)o=n(o,u,h);else if(o!==N){const t=i.createRange();t.setStartBefore(o[0]),t.setEndAfter(o[o.length-1]),t.deleteContents(),f.clear(),o=N,r=!0}})(s)},W=(t,i)=>function(e){let s=N,o=d;const r=$(t,this);(this.updates[i]=i=>{o=u(o,j(t,i)),s=n(s,o.$,r)})(e)},_=(t,i)=>function(e){const s=$(t,this);(this.updates[i]=i=>{L(s,j(t,i).value)})(e)},z=(t,i)=>function(e){let s,h,f=x;const u=$(t,this),{value:l}=j(t,e),p=t=>{s!==t&&(f(),s=t,f=o(h))};if(y(r(l))){let t=N,i=d;h=()=>{const e=c(s);i=a(i,e,!1),t=n(t,i.$,u)}}else h=()=>{L(u,c(s))};this.updates[i]=i=>p(j(t,i).value),p(l)},G=(t,i)=>function(e){let s=N,o=d,r=null;const c=$(t,this);(this.updates[i]=i=>{i=j(t,i).value,r!==i.id?(r=i.id,o=a(o,i,!1),s=n(s,o.$,c)):i.type===k?o.update(B(i)):o.update(i)})(e)},D=({children:t},i,e,s,n)=>{for(let o=0;o<t.length;o++){const r=t[o];if(r.type===P)e.appendChild(f(r.value));else e.appendChild(V(t[o],i,[],s.concat(o),n))}},V=(t,e,s,n,o)=>{let r,c;const{length:u}=e;t:switch(t.type){case M:{const{value:i}=t;switch(!0){case y(i):r=G;break;case T(i):r=F;break;case h(i):r=z;break;default:c=f(""),e.push(_(n,u));break t}}case k:c=f(""),e.push((r||W)(n,u));break;case A:{const{attributes:r,name:h}=t,f=[h],a=[];for(let t=0;t<r.length;t++){const i=r[t];i.type===M||i.dynamic?R(i)||s.push(t):("is"===i.name&&f.push({is:i.value}),a.push(i))}s.length&&e.push(U(s,n,u)),c=o||(o="svg"===h)?i.createElementNS("http://www.w3.org/2000/svg",...f):i.createElement(...f);for(const{name:t,value:i}of a)b(c,t,i,!0);D(t,e,c,n,o);break}case C:c=i.createDocumentFragment(),D(t,e,c,n,o)}return c};return(t,i)=>{const e="function"==typeof t?t():t;y||(y=O.bind(E(e)));const s=a(v.get(i)||d,e,!0);v.set(i,s),i.replaceChildren(...s.$)}};const W=(t={})=>F({...t,Signal:f,effect:w,isSignal:void 0});export{f as Signal,e as batch,v as computed,W as createRender,w as effect,u as signal};
